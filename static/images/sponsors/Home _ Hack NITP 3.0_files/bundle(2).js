!function(){"use strict";function e(e,r,t,n){return new(t||(t=Promise))((function(a,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var r;e.done?a(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,o)}c((n=n.apply(e,r||[])).next())}))}function r(e,r){var t,n,a,s,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=r.call(e,i)}catch(e){s=[6,e],n=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}var t,n,a=function(){return(a=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var a in r=arguments[t])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)},s={getHackathonData:function(e){return i.get(i._PREFIX+"hackathons/"+e).then((function(e){var r,t;if(!(null==e?void 0:e.error))return{uuid:e.uuid,slug:e.slug,name:e.name,regEndsAt:null===(r=null==e?void 0:e.hackathon_setting)||void 0===r?void 0:r.reg_ends_at,regStartsAt:null===(t=null==e?void 0:e.hackathon_setting)||void 0===t?void 0:t.reg_starts_at,devfolioOfficial:(null==e?void 0:e.devfolio_official)||!1};throw e.error}))},signIn:function(e,r,t){return i.post(i._PREFIX+"users/signin",{username:e,password:r,captcha_response:t}).then((function(r){var t;if(!(null==r?void 0:r.error))return{username:r.username,accessToken:r.access_token,refreshToken:r.refresh_token};var n=[];switch(null===(t=r.error)||void 0===t?void 0:t.message){case"Invalid username":n.push({field:"id",message:"Sorry, we couldn't find an account with that username."});break;case"Account with this email or username does not exists":n.push({field:"id",message:"Sorry, we couldn't find an account with that "+(e.includes("@")?"email":"username")});break;case"Invalid Password":n.push({field:"password",message:"Sorry, that password isn't right."});break;case"Invalid captcha response":n.push({field:"generic",message:"Sorry, we could not sign you in as the captcha validation failed."});break;case"Login attempts over":n.push({field:"generic",message:"The maximum number of login attempts has been reached. Please try again in an hour."})}throw 0===n.length&&(s.captureException(r.error),n.push({field:"generic",message:"Sorry, we could not sign you in at the moment."})),n}))},register:function(e,r,t){return i.post(i._PREFIX+"users",{email:r,password:t,username:e}).then((function(e){var r,t,n,a,i;if(!(null==e?void 0:e.error))return{username:e.username,accessToken:e.access_token,refreshToken:e.refresh_token};var o=[];if("The server received a request that could not be processed."===(null===(r=e.error)||void 0===r?void 0:r.message)){var c=null===(t=e.error)||void 0===t?void 0:t.source;if(null==c?void 0:c.email)switch(null===(n=c.email)||void 0===n?void 0:n.msg){case"email already in use":o.push({field:"email",message:"Someone (maybe you?) has already created an account using this email."});break;case"must be an email":o.push({field:"email",message:"This doesn't appear to be a valid email address. Please try a different email address."})}if(null==c?void 0:c.username)switch(null===(a=c.username)||void 0===a?void 0:a.msg){case"username not available":o.push({field:"username",message:"Another user with this username already exists. Please try a different username."});break;case"invalid username":o.push({field:"username",message:"Username must be minimum 2 characters long, and should not contain spaces or special characters."})}if(null==c?void 0:c.password)switch(null===(i=c.password)||void 0===i?void 0:i.msg){case"password must be atleast 8 characters long":o.push({field:"password",message:"Password must be minimum 8 characters long."})}}throw 0===o.length&&(s.captureException(e.error),o.push({field:"generic",message:"Sorry, we could not create your account at the moment."})),o}))},apply:function(e,r,t){var n="users/"+e+"/hackathon/"+r+"/apply";return i.post(i._PREFIX+n,{},a(a({},i._HEADERS),{access_token:t})).then((function(e){var r;if(!(null==e?void 0:e.error))return e;var t={field:"generic",message:"Unable to apply to this hackathon."};switch(null===(r=e.error)||void 0===r?void 0:r.message){case"Can't apply, hackathon registrations are not open.":t.message="Sorry, the hackathon registrations are not open.";break;case"Can't apply, hackathon registration are close.":t.message="Sorry, this hackathon is no longer accepting new registrations.";break;default:s.captureException(e.error)}throw t}))},captureException:function(e){var r;null===(r=null===window||void 0===window?void 0:window.Sentry)||void 0===r||r.captureException(e)}},i={_PREFIX:"https://devfolio.co/api/",_HEADERS:{"Content-Type":"application/json; charset=utf-8"},get:function(e,r){return void 0===e&&(e=""),fetch(e,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:r||i._HEADERS,referrer:"no-referrer"}).then((function(e){return e.json()})).catch((function(e){throw e}))},post:function(e,r,t){return void 0===e&&(e=""),void 0===r&&(r={}),fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:t||i._HEADERS,referrer:"no-referrer",body:JSON.stringify(r)}).then((function(e){var r=e.headers.get("content-type");return r&&r.includes("application/json")?e.json():e})).catch((function(e){throw e}))}};!function(e){e.SignIn="signin",e.Register="register"}(t||(t={})),function(e){e[e.Ready=0]="Ready",e[e.Progress=1]="Progress",e[e.Success=2]="Success",e[e.Failed=3]="Failed"}(n||(n={})),window.addEventListener("load",(function(){var a,i={form:document.querySelector("#signin-form"),id:document.querySelector("#signin-id"),password:document.querySelector("#signin-password"),switch:document.querySelector("#signin-switch")},o={form:document.querySelector("#register-form"),email:document.querySelector("#register-email"),username:document.querySelector("#register-username"),password:document.querySelector("#register-password"),switch:document.querySelector("#register-switch")},c=((a={})[t.SignIn]=i,a[t.Register]=o,a),u=document.querySelector("#button-close"),d=document.querySelector("#button-continue"),l={auth:{username:"",accessToken:"",refreshToken:""},hackathon:{uuid:"",slug:"",name:"",devfolioOfficial:!1,regEndsAt:"",regStartsAt:""},currentView:t.Register,formStatus:n.Ready,dispatch:{setAuth:function(e){l.auth=e},setHackathon:function(e){l.hackathon=e,document.querySelector("#banner-hackathon-name").innerHTML=e.name,d.disabled=!1},setFormStatus:function(e){switch(l.formStatus=e,e){case n.Progress:d.classList.add("loading"),d.disabled=!0,i.switch.disabled=!0,o.switch.disabled=!0,u.disabled=!0;break;default:d.classList.remove("loading"),d.disabled=!1,i.switch.disabled=!1,o.switch.disabled=!1,u.disabled=!1}},setCurrentView:function(e){var r=c[l.currentView],t=c[e];r.form.classList.add("hidden"),r.form.setAttribute("disabled","true"),t.form.setAttribute("disabled","false"),t.form.classList.remove("hidden"),d.setAttribute("form",e+"-form"),l.currentView=e}}};function h(){var e=l.currentView===t.Register?t.SignIn:t.Register;l.dispatch.setCurrentView(e)}function f(e){try{e.preventDefault(),window.grecaptcha.execute()}catch(e){console.log("(Overlay): ",e),window.Sentry.captureException(e)}}i.switch.addEventListener("click",h),o.switch.addEventListener("click",h),window.continueToDashboard=function(a){return e(this,void 0,void 0,(function(){var e;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,7,8,9]),l.dispatch.setFormStatus(n.Progress),l.currentView!==t.SignIn?[3,2]:[4,g(a)];case 1:return r.sent(),[3,4];case 2:return[4,w()];case 3:r.sent(),r.label=4;case 4:return[4,y()];case 5:return r.sent(),[4,v()];case 6:return r.sent(),l.dispatch.setFormStatus(n.Success),[3,9];case 7:return e=r.sent(),console.log("(Overlay): ",e),l.dispatch.setFormStatus(n.Failed),[3,9];case 8:return window.grecaptcha.reset(),[7];case 9:return[2]}}))}))},i.form.addEventListener("submit",f),o.form.addEventListener("submit",f);var m,p=function(e,r,t){if("generic"!==r){var n=document.querySelector("#"+e+"-"+r);document.querySelector("#"+e+"-"+r+"-error").innerHTML=t,n.classList.add("error")}else{document.querySelector("#generic-error").innerHTML=t}};function v(){var t=this;return new Promise((function(n,a){return e(t,void 0,void 0,(function(){var e,t,s;return r(this,(function(r){try{e=l.hackathon,t=l.auth,s={hackathon_id:e.uuid,username:t.username,access_token:t.accessToken,refresh_token:t.refreshToken},window.parent.location.href="https://devfolio.co/apply/"+e.slug+"?"+new URLSearchParams(s).toString(),n(s)}catch(e){a(e)}return[2]}))}))}))}function g(n){var a=this;return new Promise((function(o,c){return e(a,void 0,void 0,(function(){var e,a,u,d;return r(this,(function(r){switch(r.label){case 0:e=i.id.value,a=i.password.value,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.signIn(e,a,n)];case 2:return u=r.sent(),l.dispatch.setAuth(u),o(u),[3,4];case 3:return d=r.sent(),Array.isArray(d)&&d.forEach((function(e){p(t.SignIn,e.field,e.message)})),c(d),[3,4];case 4:return[2]}}))}))}))}function w(){var n=this;return new Promise((function(a,i){return e(n,void 0,void 0,(function(){var e,n,c,u,d;return r(this,(function(r){switch(r.label){case 0:e=o.email.value,n=o.username.value,c=o.password.value,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.register(n,e,c)];case 2:return u=r.sent(),l.dispatch.setAuth(u),a(u),[3,4];case 3:return d=r.sent(),Array.isArray(d)&&d.forEach((function(e){p(t.Register,e.field,e.message)})),i(d),[3,4];case 4:return[2]}}))}))}))}function y(){var t=this;return new Promise((function(n,a){return e(t,void 0,void 0,(function(){var e,t,i;return r(this,(function(r){switch(r.label){case 0:e=l.hackathon,t=l.auth,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.apply(t.username,e.uuid,t.accessToken)];case 2:return r.sent(),n(e),[3,4];case 3:return(null==(i=r.sent())?void 0:i.field)&&(null==i?void 0:i.message)&&p(l.currentView,i.field,i.message),a(i),[3,4];case 4:return[2]}}))}))}))}function b(){window.parent.postMessage({type:"CLOSE_OVERLAY"},"*")}document.querySelectorAll(".input").forEach((function(e){e.addEventListener("input",(function(){e.classList.remove("error")}))})),u.addEventListener("click",b),window.addEventListener("keydown",(function(e){"Escape"===e.key&&l.formStatus!==n.Progress&&b()})),window.addEventListener("message",(function(e){var r=e.isTrusted,t=e.data;r&&"SEND_HACKATHON_DATA"===(null==t?void 0:t.type)&&l.dispatch.setHackathon(e.data.payload)})),(m=document.createElement("script")).src="https://js.sentry-cdn.com/9e00427c767b4e838f64e7581b3952d5.min.js",m.crossOrigin="anonymous",m.addEventListener("load",(function(){window.Sentry.init({environment:"production"}),window.Sentry.configureScope((function(e){var r=l.hackathon;e.setTag("hackathon",r.name),e.setExtras(r)}))})),document.head.appendChild(m)})),window.grecaptchaOnload=function(){window.grecaptcha.render("g-recaptcha",{sitekey:"6LexNNUUAAAAAN_eHY_-SHuzT1JjQZ-hbUebX35S",callback:"continueToDashboard",size:"invisible"})}}();
//# sourceMappingURL=bundle.js.map
